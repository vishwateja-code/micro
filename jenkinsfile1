pipeline {
    agent any

    stages {
        stage('Build all services') {
            steps {
                script {
                    def services = [
                        'adservice',
                        'cartservice',
                        'checkoutservice',
                        'currencyservice',
                        'emailservice',
                        'frontend',
                        'loadgenerator',
                        'paymentservice',
                        'productcatalogservice',
                        'recommendationservice',
                        'shippingservice'
                    ]

                    for (service in services) {
                        echo "Running Jenkinsfile for ${service}"
                        load "jenkinsfile/${service}/Jenkinsfile"
                    }
                }
            }
        }
    }
}
